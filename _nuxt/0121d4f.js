(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{839:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var o=n(4),r=function(t,e,n){o.a.prototype.$swal({position:"top-end",title:t,icon:e,timer:n,showConfirmButton:!1,toast:!0})}},914:function(t,e,n){"use strict";n.r(e);n(143),n(28),n(77),n(144),n(78),n(163),n(412),n(43);var o=n(17),r=n(32),l=(n(872),n(56),n(164),n(169),n(874),n(879),n(881),n(882),n(883),n(884),n(885),n(886),n(887),n(888),n(889),n(890),n(891),n(893),n(894),n(895),n(896),n(897),n(898),n(899),n(900),n(901),n(902),n(903),n(839));function c(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function d(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var m={layout:"admin",data:function(){return{categorys:[],visible:!1,visibleModal:!1,previewVisible:!1,disableBtnUpload:!0,previewImage:"",fileList:[],images:[],btnLoading:!1,form:{title:"",content:"",slug:"",image:"",category:void 0}}},fetch:function(){var t=this;this.$fire.database.ref("images/").get().then((function(e){if(e.exists()){var n=[];for(var o in e.val())n.push(d({},e.val()[o]));t.images=n.sort((function(a,b){return b.date-a.date}))}})),this.$fire.database.ref("categorys/").get().then((function(e){if(e.exists()){var n=[];for(var o in e.val())n.push(d(d({},e.val()[o]),{},{id:o}));t.categorys=n}}))},head:function(){return{title:this.$t("Tạo mới bài viết")+" | Thanh Thúy"}},methods:{test:function(){},onShowDrawer:function(){this.visible=!0},onCloseDrawer:function(){this.visible=!1},resetForm:function(){this.form={title:"",content:"",slug:"",category:void 0}},onGetLink:function(t){var e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),Object(l.a)(this.$t("Sao chép thành công"),"success","2000")},onCreate:function(){var t=this;if(this.form.title&&this.form.slug){this.btnLoading=!0;var e=this.$fire.database.ref("articles/");e.orderByChild("slug").equalTo(this.form.slug).once("value",(function(n){n.exists()?(t.btnLoading=!1,Object(l.a)(t.$t("Đường link bài viết tồn tại, Vui lòng chọn link khác hoặc xóa bài viết cũ"),"warning","3000")):e.push().set({slug:t.form.slug,title:t.form.title,content:t.form.content,images:t.form.image,author:t.$store.state.user.uid,category:t.form.category,date:Date.now()}).then((function(){setTimeout((function(){t.btnLoading=!1,t.resetForm(),Object(l.a)(t.$t("Tạo thành công"),"success","2000")}),1e3)})).catch((function(){t.btnLoading=!1,Object(l.a)(t.$t("Tạo thất bại"),"error","3000")}))}))}else Object(l.a)(this.$t("Còn một vài trường còn trống"),"error","3000")},openModalUpload:function(){this.visibleModal=!0},closeModalUpload:function(){this.visibleModal=!1,this.fileList=[]},closeModalPreview:function(){this.previewVisible=!1},handlePreview:function(t){t.url||t.preview||(t.preview=URL.createObjectURL(t.originFileObj)),this.previewImage=t.url||t.preview,this.previewVisible=!0},dummyRequest:function(t){setTimeout((function(){t.onSuccess("ok")}),0)},handleChangeImage:function(t){this.fileList=t.fileList,"done"===t.file.status&&(this.fileList=t.fileList),"error"===t.file.status&&(this.fileList=t.fileList),"removed"===t.file.status&&(this.fileList=t.fileList),this.fileList.length>0?this.disableBtnUpload=!1:this.disableBtnUpload=!0},onSubmit:function(){var t=this;this.btnLoading=!0,new Promise((function(e,n){t.fileList.forEach((function(n,o){var r=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(t){return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)})),l=Date.now();t.$fire.storage.ref("articles/"+r).put(n.originFileObj).then((function(n){n.ref.getDownloadURL().then((function(n){t.addImage(r,n,l),o===t.fileList.length-1&&e()}))}))}))})).then((function(){t.closeModalUpload(),t.btnLoading=!1,t.$fetch()}))},addImage:function(t,e,n){this.$fire.database.ref("images/"+t).set({id:t,url:e,date:n})},onDeleteImage:function(img){var t=this;this.$fire.storage.ref("articles/").child(img.id).delete().then(Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$fire.database.ref("images/"+img.id).remove();case 2:Object(l.a)(t.$t("Xóa thành công"),"success","2000"),t.$fetch();case 4:case"end":return e.stop()}}),e)})))).catch((function(){Object(l.a)(t.$t("Xóa thất bại"),"error","3000")}))}}},f=n(18),component=Object(f.a)(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"admin-content create-post"},[n("div",{staticClass:"options"},[n("div",{staticClass:"left"},[n("a-breadcrumb",[n("a-breadcrumb-item",[n("nuxt-link",{attrs:{to:"/dashboard"}},[t._v(t._s(t.$t("Trang chủ")))])],1),t._v(" "),n("a-breadcrumb-item",[t._v(t._s(t.$t("Tạo mới bài viết")))])],1)],1),t._v(" "),n("div",{staticClass:"right"},[n("a-button",{attrs:{type:"primary"},on:{click:t.openModalUpload}},[t._v(" "+t._s(t.$t("Thêm hình ảnh"))+" ")]),t._v(" "),n("a-button",{attrs:{type:"primary"},on:{click:t.onShowDrawer}},[t._v(" "+t._s(t.$t("Danh sách hình ảnh"))+" ")]),t._v(" "),n("a-drawer",{staticClass:"drawer-img",attrs:{title:t.$t("Danh sách hình ảnh"),width:"728",placement:"right",visible:t.visible},on:{close:t.onCloseDrawer}},[n("template",{slot:"closeIcon"},[n("icon-close",{staticClass:"icon"})],1),t._v(" "),n("div",{staticClass:"images"},t._l(t.images,(function(e,o){return n("div",{key:o,staticClass:"images__item"},[n("div",{staticClass:"images__item-img"},[n("img",{attrs:{src:e.url,alt:e.id}})]),t._v(" "),n("div",{staticClass:"images__item-icon"},[n("a-tooltip",{attrs:{placement:"bottom"}},[n("template",{slot:"title"},[n("span",[t._v(t._s(t.$t("Sao chép")))])]),t._v(" "),n("a-icon",{staticClass:"icon",attrs:{type:"link"},on:{click:function(n){return t.onGetLink(e.url)}}})],2),t._v(" "),n("a-tooltip",{attrs:{placement:"bottom"}},[n("template",{slot:"title"},[n("span",[t._v(t._s(t.$t("Xóa")))])]),t._v(" "),n("a-popconfirm",{attrs:{title:t.$t("Bạn chắc chắn xóa ảnh này"),"ok-text":"Yes","cancel-text":"No"},on:{confirm:function(n){return t.onDeleteImage(e)}}},[n("a-icon",{staticClass:"icon",attrs:{type:"delete"}})],1)],2)],1)])})),0)],2),t._v(" "),n("a-modal",{staticClass:"modal-avatar",attrs:{title:t.$t("Thêm hình ảnh")},on:{cancel:t.closeModalUpload},model:{value:t.visibleModal,callback:function(e){t.visibleModal=e},expression:"visibleModal"}},[n("template",{slot:"closeIcon"},[n("icon-close",{staticClass:"icon"})],1),t._v(" "),n("template",{slot:"footer"},[n("a-button",{key:"submit",attrs:{size:"large",type:"primary",disabled:t.disableBtnUpload,loading:t.btnLoading},on:{click:t.onSubmit}},[t._v("\n            "+t._s(t.$t("Thêm hình ảnh"))+"\n          ")])],1),t._v(" "),n("a-upload",{attrs:{"list-type":"picture-card",accept:".png, .jpg, .jpeg",multiple:!0,"custom-request":t.dummyRequest,"file-list":t.fileList},on:{preview:t.handlePreview,change:t.handleChangeImage}},[n("a-icon",{attrs:{type:"upload"}}),t._v("\n          "+t._s(t.$t("Tải ảnh lên"))+"\n        ")],1),t._v(" "),n("a-modal",{staticClass:"modal-preview",attrs:{visible:t.previewVisible,footer:null},on:{cancel:t.closeModalPreview}},[n("template",{slot:"closeIcon"},[n("icon-close",{staticClass:"icon text-main"})],1),t._v(" "),n("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:t.previewImage}})],2)],2)],1)]),t._v(" "),n("div",{staticClass:"form"},[n("a-row",{attrs:{gutter:16}},[n("a-col",{attrs:{lg:12}},[n("div",{staticClass:"form-item"},[n("a-input",{attrs:{placeholder:"Tiêu đề bài viết",size:"large"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),t._v(" "),n("div",{staticClass:"form-item"},[n("a-input",{attrs:{placeholder:"URL cho SEO",size:"large"},model:{value:t.form.slug,callback:function(e){t.$set(t.form,"slug",e)},expression:"form.slug"}})],1)]),t._v(" "),n("a-col",{attrs:{lg:12}},[n("div",{staticClass:"form-item"},[n("a-input",{attrs:{placeholder:"Hình nền",size:"large"},model:{value:t.form.image,callback:function(e){t.$set(t.form,"image",e)},expression:"form.image"}})],1),t._v(" "),n("div",{staticClass:"form-item"},[n("a-select",{staticStyle:{width:"100%"},attrs:{size:"large",placeholder:t.$t("Danh mục")},model:{value:t.form.category,callback:function(e){t.$set(t.form,"category",e)},expression:"form.category"}},t._l(t.categorys,(function(e){return n("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v(" "+t._s(e.name))])})),1)],1)])],1),t._v(" "),n("div",{staticClass:"form-item"},[n("Editor",{ref:"tinymce",attrs:{"api-key":"9gi810x0im6yepc6cxno6g7eesn864ankt17r4hbl45b4i7d",init:{height:1e3,menubar:!1,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code help wordcount","imageresizing"],toolbar:"undo redo print table | formatselect | fontselect | fontsizeselect | bold italic underline forecolor backcolor | link image | alignleft aligncenter alignright alignjustify lineheight | bullist numlist outdent indent",fontsize_formats:"8px 10px 12px 14px 16px 18px 24px 36px 48px",content_style:"body { font-family:Helvetica,Arial,sans-serif; font-size:18px }",statusbar:!1,image_advtab:!0,setup:function(t){t.editorManager.PluginManager.add("imageresizing",(function(t,e){t.on("ObjectResizeStart",(function(e){if("IMG"===e.target.nodeName){var n=t.editorManager.activeEditor.selection.getNode();t.editorManager.activeEditor.dom.setStyle(n,"width",e.width),t.editorManager.activeEditor.dom.setStyle(n,"height",e.height),n.removeAttribute("width"),n.removeAttribute("height")}}))}))}}},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),t._v(" "),n("div",{staticClass:"form-item btn-create"},[n("a-button",{attrs:{type:"primary",loading:t.btnLoading,size:"large"},on:{click:t.onCreate}},[t._v(" Tạo bài viết ")]),t._v(" "),n("a-button",{attrs:{type:"primary",size:"large"},on:{click:t.test}},[t._v(" test ")])],1)],1)])}),[],!1,null,null,null);e.default=component.exports}}]);